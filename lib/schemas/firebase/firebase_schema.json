{
  "openapi": "3.0.3",
  "info": {
    "title": "Job",
    "version": "2.0.0",
    "description": "Use this schema when sending data from the backend to Firebase to be consumed by the app"
  },
  "paths": {},
  "components": {
    "schemas": {
      "Job": {
        "type": "object",
        "properties": {
          "rmsSchemaVersion": {
            "type": "string",
            "nullable": false,
            "description": "The rms_schema repository tag / version",
            "example": "1.1.0"
          },
          "account": {
            "type": "string",
            "x-mapped-to": "ProviderName",
            "nullable": true
          },
          "agentCode": {
            "type": "string",
            "x-mapped-to": "JobContractCode",
            "nullable": true
          },
          "ansNotes": {
            "type": "string",
            "x-mapped-to": "JobAnsNotes",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "areImagesRequired": {
            "type": "boolean",
            "x-mapped-to": "JobAreImagesRequired",
            "nullable": false
          },
          "authorisedMiles": {
            "type": "integer",
            "x-mapped-to": "JobAuthorisedMiles",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "bookEarliestDateTime": {
            "type": "string",
            "format": "date-time",
            "x-firestore-type": "timestamp",
            "x-mapped-to": "JobBookEarliestDateTime",
            "nullable": true
          },
          "bookLatestDateTime": {
            "type": "string",
            "format": "date-time",
            "x-firestore-type": "timestamp",
            "x-mapped-to": "JobBookLatestDateTime",
            "nullable": true
          },
          "caseNumber": {
            "type": "string",
            "x-mapped-to": "JobCaseNumber",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "categoryOfServiceToBeProvided": {
            "type": "string",
            "x-mapped-to": "JobCategoryOfServiceToBeProvided",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "conditionReportEmailAddress": {
            "type": "string",
            "x-mapped-to": "RCREmailAddress",
            "nullable": true
          },
          "controllerContactDetails": {
            "type": "string",
            "x-mapped-to": "JobControllerContactDetails",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "dateTime": {
            "type": "string",
            "format": "date-time",
            "x-firestore-type": "timestamp",
            "x-mapped-to": "JobDateTime",
            "nullable": false
          },
          "destination": {
            "$ref": "#/components/schemas/JobDestination",
            "nullable": true
          },
          "docId": {
            "type": "string",
            "x-mapped-to": "NEW",
            "description": "The unique document id for this job in Firebase Firestore",
            "nullable": false
          },
          "driverUid": {
            "type": "string",
            "x-mapped-to": "NEW",
            "description": "Driver's unique identifier i.e. <installation-code>-<user-uid>",
            "example": "000001-3",
            "nullable": false
          },
          "eta": {
            "type": "string",
            "format": "date-time",
            "x-firestore-type": "timestamp",
            "x-mapped-to": "NEW",
            "nullable": true
          },
          "eventType": {
            "$ref": "#/components/schemas/JobEventTypeValues",
            "nullable": true
          },
          "hasSpecialNeeds": {
            "type": "boolean",
            "x-mapped-to": "JobHasSpecialNeeds",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "id": {
            "type": "string",
            "x-mapped-to": "JobId",
            "description": "The job id - note that an ANS job does not have a job id",
            "nullable": true
          },
          "isCancelled": {
            "type": "boolean",
            "x-mapped-to": "NEW",
            "nullable": false
          },
          "isFaultOutcomeAnsStandard": {
            "type": "boolean",
            "x-mapped-to": "NEW",
            "nullable": true
          },
          "isRedeployable": {
            "type": "boolean",
            "x-mapped-to": "NEW",
            "nullable": false
          },
          "location": {
            "$ref": "#/components/schemas/JobLocation",
            "nullable": true
          },
          "locationOfKeys": {
            "type": "string",
            "x-mapped-to": "JobLocationOfKeys",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "orderNumber": {
            "type": "string",
            "x-mapped-to": "JobOrderNumber",
            "nullable": false
          },
          "owner": {
            "$ref": "#/components/schemas/JobOwner",
            "nullable": true
          },
          "passengers": {
            "$ref": "#/components/schemas/JobPassengers",
            "nullable": true
          },
          "priority": {
            "$ref": "#/components/schemas/JobPriority",
            "nullable": true
          },
          "requiredTowType": {
            "type": "string",
            "x-mapped-to": "JobRequiredTowType",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "ringOnApproachMinutes": {
            "type": "integer",
            "x-mapped-to": "JobRingOnApproachMinutes",
            "nullable": true
          },
         "service": {
            "$ref": "#/components/schemas/JobService",
            "nullable": false
          },
          "symptom": {
            "type": "object",
            "properties": {
              "code": {
                "type": "string",
                "x-mapped-to": "JobSymptomCode",
                "nullable": true
              },
              "description": {
                "type": "string",
                "x-mapped-to": "JobSymptomDescription",
                "nullable": true
              }
            },
            "nullable": true
          },
          "towedItem": {
            "$ref": "#/components/schemas/JobTowedItem",
            "nullable": true
          },
          "rmsJobType": {
            "$ref": "#/components/schemas/JobRMSTypeValues",
            "nullable": true
          },
          "vehicle": {
            "type": "object",
            "properties": {
              "axleType": {
                "type": "string",
                "x-mapped-to": "JobVehicleAxleType",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "type": {
                "$ref": "#/components/schemas/JobVehicleTypeValues",
                "nullable": true
              },
              "colour": {
                "type": "string",
                "x-mapped-to": "JobVehicleColour",
                "nullable": true
              },
              "contents": {
                "type": "string",
                "x-mapped-to": "JobVehicleContents",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "engineDetails": {
                "type": "string",
                "x-mapped-to": "JobVehicleEngineDetails",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "fuelType": {
                "$ref": "#/components/schemas/JobVehicleFuelTypeValues",
                "nullable": true
              },
              "grossWeight": {
                "type": "string",
                "x-mapped-to": "JobVehicleGrossWeight",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "hasTrailer": {
                "type": "boolean",
                "x-mapped-to": "JobVehicleHasTrailer",
                "nullable": true
              },
              "height": {
                "type": "string",
                "x-mapped-to": "JobVehicleHeight",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "length": {
                "type": "string",
                "x-mapped-to": "JobVehicleLength",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "make": {
                "type": "string",
                "x-mapped-to": "JobVehicleMake",
                "nullable": true
              },
              "model": {
                "type": "string",
                "x-mapped-to": "JobVehicleModel",
                "nullable": true
              },
              "numberOfDoors": {
                "type": "string",
                "x-mapped-to": "JobVehicleNoOfDoors",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "odometer": {
                "type": "string",
                "x-mapped-to": "JobVehicleOdometer",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "registration": {
                "type": "string",
                "x-mapped-to": "JobVehicleRegistration",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "trailerType": {
                "type": "string",
                "x-mapped-to": "JobVehicleTrailerType",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "transmissionType": {
                "$ref": "#/components/schemas/JobVehicleTransmissionTypeValues",
                "nullable": true
              },
              "vin": {
                "type": "string",
                "x-mapped-to": "JobVehicleVIN",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              },
              "width": {
                "type": "string",
                "x-mapped-to": "JobVehicleWidth",
                "x-used-in-legacy-notes-section": true,
                "nullable": true
              }
            },
            "nullable": true
          },
          "vvrfAccountId": {
            "type": "integer",
            "x-mapped-to": "JobVVRFAccountId",
            "nullable": true
          },
          "userUpdates": {
            "$ref": "#/components/schemas/JobUserUpdates",
            "nullable": true
          }
        },
        "required": [
          "agentCode",
          "areImagesRequired",
          "dateTime",
          "docId",
          "driverUid",
          "isCancelled",
          "isRedeployable",
          "orderNumber",
          "service",
          "rmsSchemaVersion"
        ]
      },
      "JobEventTypeValues": {
        "type": "string",
        "enum": [
          "newJob",
          "updatedJob",
          "cancelledJob",
          "acceptedJob"
        ]
      },
      "JobRMSTypeValues": {
        "type": "string",
        "enum": [
          "recovery",
          "redelivery"
        ]
      },
      "JobVehicleFuelTypeValues": {
        "type": "string",
        "x-mapped-to": "JobVehicleFuelType",
        "enum": [
          "diesel",
          "petrol",
          "ev",
          "hybrid",
          "hydrogen",
          "lpg",
          "other"
        ]
      },
      "JobVehicleTransmissionTypeValues": {
        "type": "string",
        "x-mapped-to": "JobVehicleTransmissionType",
        "enum": [
          "manual",
          "auto",
          "manual_4wd",
          "auto_4wd",
          "unknown"
        ]
      },
      "JobVehicleTypeValues": {
        "type": "string",
        "x-mapped-to": "JobVehicleClass",
        "enum": [
          "bike",
          "car",
          "caravan",
          "coach",
          "truck",
          "van"
        ]
      },
      "Deltas": {
        "type": "object",
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "rmsSchemaVersion": {
            "type": "string",
            "nullable": true,
            "description": "The schema version of this repository",
            "example": "1.1.0"
          },
          "driverUid": {
            "type": "string",
            "description": "Driver's unique identifier i.e. <installation-code>-<user-uid>",
            "example": "000001-3",
            "nullable": true
          },
          "jobs": {
            "$ref": "#/components/schemas/JobUserUpdates",
            "nullable": true
          },
          "activities": {
            "type": "object",
            "properties": {}
          },
          "vehicleCheck": {
            "type": "object",
            "properties": {}
          },
          "fuelEntry": {
            "type": "object",
            "properties": {}
          },
          "clockInOut": {
            "type": "object",
            "properties": {}
          },
          "messages": {
            "type": "object",
            "properties": {}
          },
          "forms": {
            "type": "object",
            "properties": {}
          },
          "redFlashingLight": {
            "type": "object",
            "properties": {}
          }
        }
      },
      "JobUserUpdates": {
        "type": "object",
        "properties": {
          "docId": {
            "type": "string",
            "description": "The unique document id for this job in Firebase Firestore",
            "nullable": true
          },
          "jobAcceptance": {
            "$ref": "#/components/schemas/JobAcceptance",
            "nullable": true
          },
          "jobRejection": {
            "$ref": "#/components/schemas/JobRejectionReasonValues",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/JobStatusValues",
            "nullable": true
          },
          "statusHistory": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JobStatus",
              "nullable": false
            },
            "nullable": true
          }
        }
      },
      "JobStatus": {
        "type": "object",
        "properties": {
          "value": {
            "$ref": "#/components/schemas/JobStatusValues"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "value",
          "timestamp"
        ]
      },
      "JobStatusValues": {
        "type": "string",
        "enum": [
          "none",
          "redeployed",
          "accepted",
          "onRoute",
          "atScene",
          "clear",
          "complete",
          "cancelled"
        ]
      },
      "JobRejectionReasonValues": {
        "type": "string",
        "enum": [
          "nightControl",
          "tooBusyToDeal",
          "outOfArea",
          "extremeWeatherConditions",
          "extremeTrafficConditions",
          "noVehiclesFacilitiesAvailable",
          "noStaffAvailable",
          "inDisputeWithOrganisationOrMember",
          "unableToAttendWithinEta",
          "unableToDoRecoveryAfterRoadsideAssist",
          "temporarilyUnavailableOrOffDutyOrClosed",
          "guaranteeOfPaymentNotGiven",
          "noLicenseForThisClass",
          "outOfDriverHours",
          "unableToDoJobOrSupplyParts",
          "alreadyWorkingForThisOrganisation",
          "telephoneOrModemNoAnswer",
          "telephoneOrModemRepeatedlyEngaged",
          "telephoneOrModemUnobtainable",
          "passedToFitter",
          "retransmitRequest"
        ],
        "description": "Reasons why a job may be refused by an agent or provider."
      },
      "JobAcceptance": {
        "type": "object",
        "properties": {
          "eta": {
            "type": "string",
            "format": "date-time",
            "x-firestore-type": "timestamp"
          },
          "note": {
            "type": "string",
            "nullable": true
          }
        },
        "required": [
          "eta"
        ]
      },
      "JobTowedItem": {
        "type": "object",
        "properties": {
          "axleType": {
            "type": "string",
            "x-mapped-to": "JobTowedItemAxleType",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "description": {
            "type": "string",
            "x-mapped-to": "JobTowedItemDesc",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "height": {
            "type": "number",
            "format": "double",
            "x-mapped-to": "JobTowedItemHeight",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "length": {
            "type": "number",
            "format": "double",
            "x-mapped-to": "JobTowedItemLength",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "weight": {
            "type": "integer",
            "x-mapped-to": "JobTowedItemWeight",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "width": {
            "type": "number",
            "format": "double",
            "x-mapped-to": "JobTowedItemWidth",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          }
        }
      },
      "JobDestination": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "x-mapped-to": "JobDestinationCode",
            "nullable": true
          },
          "description": {
            "type": "string",
            "x-mapped-to": "JobDestination",
            "nullable": true
          },
          "gps": {
            "type": "object",
            "x-mapped-to": "NEW",
            "x-firestore-type": "geopoint",
            "nullable": true
          }
        }
      },
      "JobService": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "nullable": false
          }
        },
        "required": [
          "id"
        ]
      },
      "JobLocation": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "x-mapped-to": "JobLocationCode",
            "nullable": true
          },
          "description": {
            "type": "string",
            "x-mapped-to": "JobLocationDescription",
            "nullable": true
          },
          "gps": {
            "type": "object",
            "x-mapped-to": "NEW",
            "x-firestore-type": "geopoint",
            "nullable": true
          }
        }
      },
      "JobOwner": {
        "type": "object",
        "properties": {
          "address": {
            "type": "string",
            "x-mapped-to": "JobOwnerAddress",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "alternatePhone": {
            "type": "string",
            "x-mapped-to": "JobOwnerAlternatePhone",
            "nullable": true
          },
          "membershipNumber": {
            "type": "string",
            "x-mapped-to": "JobOwnerMembershipNo",
            "nullable": true
          },
          "name": {
            "type": "string",
            "x-mapped-to": "JobOwnerName",
            "nullable": true
          },
          "phone": {
            "type": "string",
            "x-mapped-to": "JobOwnerPhone",
            "nullable": true
          },
          "postcode": {
            "type": "string",
            "x-mapped-to": "JobOwnerPostcode",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          }
        }
      },
      "JobPassengers": {
        "type": "object",
        "properties": {
          "adult": {
            "type": "integer",
            "x-mapped-to": "JobPassengerAdult",
            "nullable": true
          },
          "child": {
            "type": "integer",
            "x-mapped-to": "JobPassengerChild",
            "nullable": true
          }
        }
      },
      "JobPriority": {
        "type": "object",
        "properties": {
          "detail": {
            "type": "string",
            "x-mapped-to": "JobPriorityDetail",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          },
          "reason": {
            "type": "integer",
            "x-mapped-to": "JobPriorityReason",
            "x-used-in-legacy-notes-section": true,
            "nullable": true
          }
        }
      }
    }
  }
}
